## 3.5 評估 YOLO 模型

## 介紹
在物件偵測任務中，精確度與速度通常是相互牽制的關係。YOLO 的理念則是在保證較快速度的情況下，盡量提高辨識的準確率，它可以完成很多現實中的應用，只要在硬體上用對了，如行人偵測、停車位監控、室內直播 … 等等任務都是可以協助我們完成的。

YOLO 使用「單次邊緣框位置檢測」做為物件偵測的架構，也就是只需要運行一次網絡就可以處理整幅圖像，是一種快速且准確的模型。該模型最早由 Joseph Redmon 等人在 2016 年發表，目前已經發展到了第四個版本。

本篇文章將探討如何評估 YOLO 模型的效能，並提供一些優化模型的建議。

## 模型評估

YOLO 模型的評估通常會使用 mAP (mean average precision) 衡量，它可以度量分類器的準確性與召回率。透過這個指標，我們就能夠客觀的參考模型的表現，並進行優化。

以下是基於 VOC2007 的資料集，使用 Darknet 的預訓練 YOLOv3 的測試結果：

|類別       |AP         |與 IoU = 0.50:0.95 的 AP|
|:---------:|:---------:|:------------------:|
|aeroplane  |0.768     |0.522               |
|bicycle    |0.842     |0.663               |
|bird       |0.687     |0.452               |
|boat       |0.584     |0.385               |
|bottle     |0.317     |0.150               |
|bus        |0.864     |0.738               |
|car        |0.824     |0.665               |
|cat        |0.837     |0.690               |
|chair      |0.471     |0.254               |
|cow        |0.741     |0.565               |
|diningtable|0.679     |0.464               |
|dog        |0.821     |0.670               |
|horse      |0.830     |0.660               |
|motorbike  |0.842     |0.644               |
|person     |0.796     |0.623               |
|pottedplant|0.381     |0.182               |
|sheep      |0.661     |0.480               |
|sofa       |0.726     |0.523               |
|train      |0.840     |0.709               |
|tvmonitor  |0.663     |0.515               |
|總平均      |0.727     |0.536               |

可以看到平均的 mAP 是 0.536，與 IoU = 0.50 的 mAP 是 0.727。如果使用更高的 IoU 值，Yolo 模型的準確度就會大大降低，而使用更低的 IoU 值，模型的除錯也就更加容易。

## 提高模型效能的建議

為了最大化 YOLO 的效能，以下是一些提高模型效能的建議：

### 1. 調整 anchor box 大小

YOLOv3 使用了三種比例的 anchor boxes，透過這種方式，YOLOv3 不僅去掉了對採樣的需求，還提高了分辨率。如果您需要在特定的應用場景中進一步優化模型，可以嘗試調整 anchor box 的大小，以符合您的訓練數據。如果模型的效能還是不如預期，可以嘗試使用不同大小的 anchor box，這樣可以讓模型更好地擬合數據。

### 2. 優化訓練集

訓練數據集的質量對模型的效能有很大的影響。如果您的數據質量不高，就會對模型效能造成很大的影響。因此，建議優化數據集，可以將一些雜訊、缺失值和不良樣本和不良圖像從訓練集中剔除，以提高模型的準確率。

### 3. 調整卷積核數量

如果您的 GPU 資源比較充足，可以試著增加卷積核的數量。透過增加卷積核的數量，可以增加模型的深度和複雜度，進而提高模型的非線性助威能力。

### 4. 優化超參數

最後，嘗試調整模型的超參數。例如 learning rate、batch size、momentum 參數等等。調整好這些參數，可以為模型訓練提供更好的基準。

綜上所述，YOLO 模型是一種有效的物件偵測模型，但在自己的專案中要根據情況進行優化。通過反覆的優化和調整，您可以根據自己的需求和限制，定制出適合自己的最佳模型，提高模型的定位準確率，進行更好的物件偵測。