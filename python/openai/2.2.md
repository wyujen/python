## 2.2 YOLO 算法流程

Yolo（You Only Look Once）算法是現代目標檢測技術的重要代表，它通過利用卷積神經網絡（CNN）和網格單元（grid cells）對圖片中的物體進行檢測，並實現絕對實時的性能。Yolo算法最初由美國新墨西哥州大學的Joseph Redmon 提出，至今已推出了許多版本，其中 Yolov4 是最新版本，效果最好的版本之一。下面，我們將對 Yolo 算法的流程進行詳細介紹。

Yolo 算法的流程可以分為兩個主要部分，一是訓練期間，二是測試期間。在訓練期間，算法通過從大量的標註圖像中學習，從而可以將新的圖像中的物體檢測出來。在測試期間，算法將對未知圖像進行目標檢測。

以下是 Yolo 算法的主要流程：

### 1. 準備數據集

首先，需要準備標註好的圖像數據集，每張圖像將物體的位置和分類信息進行標註，可以使用標籤工具完成標註任務，在圖片中標註出每個物體的位置和對應的物體類別。

標籤格式一般為 (category_id,center_x,center_y,width,height)，其中 category_id 表示物體屬於哪一類，center_x 和 center_y 表示物體的中心點的坐標，width 和 height 表示物體的長和寬。

### 2. 網格劃分

在圖片上劃分出網格，每個網格中心點都需要負責檢測該網格內出現的物體。通常情況下，一張圖片會被劃分成 S × S 個網格，每個網格尺寸為 W / S × H / S，W 和 H 分別為圖片的寬度和高度。

### 3. 構建 CNN 模型

在 Yolo 算法中，CNN 模型用於從圖像中提取特徵，並為每個網格預測出對應的物體類別、中心點位置以及邊界框大小等信息。Yolo 使用了 Darknet 的架構，其包含了 24 層卷積層和 2 層全連接層，在網絡的輸出層可以得到一個 S × S × (B×5+C) 的張量，其中 B 為每個網格預測的邊界框數量，C 代表物體類別數量。

### 4. 預測邊界框

針對每個網格，CNN 會針對物體的中心位置進行偏移量的預測，並預測出圖像中每個邊界框的置信度得分。在每個網格中，可能存在多個邊界框，這些邊界框是由中心點的偏移量和長寬的指數進行預測的，這些預測值最終被轉換成實際像素的位置和長寬。Yolo 使用 IoU（交叉比）優化算法對預測框和實際標註框進行訓練，從而使得算法更加準確地進行物體檢測。

### 5. 非極大值抑制

在 Yolo 算法中，網格單元負責檢測各自負責的網格內出現的物體，但是可能會出現同一個物體被多個網格檢測出來的情況。為了避免這種情況，Yolo 使用非極大值抑制（NMS）將重複檢測的物體進行過濾，保留最信任值高的邊界框。

### 6. 檢測圖像中的物體

當訓練完成後，算法可以對新的圖像進行目標檢測。首先，對圖像進行網格劃分，然後透過 CNN 網絡對每個網格進行預測，得到物體類別、邊界框位置和置信度得分等信息。接著對每個網格中的邊界框進行非極大值抑制的擺動處理，最終得到圖像中所有的檢測結果。

總的來說，Yolo 算法通過網格劃分和 CNN 網絡預測的方式，快速且準確地對圖像中的物體進行檢測，其絕對實時的性能和高精度判斷能力，使得它成為現代目標檢測的一個典範。